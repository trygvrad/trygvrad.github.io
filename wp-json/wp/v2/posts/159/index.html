{"id":159,"date":"2024-07-24T10:49:32","date_gmt":"2024-07-24T10:49:32","guid":{"rendered":"http:\/\/bentus\/?p=159"},"modified":"2024-07-24T11:19:18","modified_gmt":"2024-07-24T11:19:18","slug":"multivariate-colormaps-for-n-dimensions","status":"publish","type":"post","link":"http:\/\/bentus\/multivariate-colormaps-for-n-dimensions\/","title":{"rendered":"Multivariate colormaps for n dimensions"},"content":{"rendered":"\n<p>Much work has been done in the last decade related to 1-dimensional colormaps (see for eaxmple <a href=\"https:\/\/arxiv.org\/search\/cs?searchtype=author&amp;query=Kovesi,+P\">Peter Kovesis paper<\/a> and <a href=\"https:\/\/www.youtube.com\/watch?v=xAoljeRJ3lU\">Nathaniel Smith and St\u00e9fan van der Walts talk<\/a> (2015)).<\/p>\n\n\n\n<p>This post follows my previous post on<a href=\"..\/designing-2d-colormaps\"> 2D colormaps<\/a>, and many of the design principles will be the same. However, with n \u2265 3, it quickly becomes unfeasible to create a full lookup table. With n = 3 channels and 256 values in each channel, the lookup table would be a matrix of 256^3 elements, likely much larger than the image the colormap is applied to. Instead, n independent 1D lookup tables are created, and the resulting colors are then combined.<\/p>\n\n\n\n<!--more-->\n\n\n\n<p>The simplest approach is to assign one color channel (R, G, B) to each channel in the image; in the below image the same data is shown mapped to (R, G, B) and (G, B, R): <a href=\"ttps:\/\/arxiv.org\/abs\/1812.10366\" data-type=\"link\" data-id=\"ttps:\/\/arxiv.org\/abs\/1812.10366\">[data source]<\/a><\/p>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-full\"><img loading=\"lazy\" decoding=\"async\" width=\"718\" height=\"303\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image.png\" alt=\"\" class=\"wp-image-180\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image.png 718w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-300x127.png 300w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-600x253.png 600w\" sizes=\"(max-width: 718px) 100vw, 718px\" \/><\/figure><\/div>\n\n\n<p>Both images above display the same data, with the same normalization, but by swapping the color different aspects are highlighted. The green channel has higher perceptual lightness and saturation, and the features of the green channel are therefore highlighted. <br>The lightness and saturation of the R, G and B channels can be visualized by displaying the three channels in a perceptually uniform colorspace. <\/p>\n\n\n\n<iframe loading=\"lazy\" src=\"https:\/\/trygvrad.github.io\/plotly_multivar_colormaps\/RGB_multivar.html\" height=\"520\" width=\"420\" frameborder=\"0\" allow=\"fullscreen\"><\/iframe>\n\n\n\n<p>We can define the following figures of merit for multivariate colormaps:<\/p>\n\n\n\n<ol class=\"wp-block-list\">\n<li>Each channel should be perceptually uniform.<\/li>\n\n\n\n<li>All channels should have similar lightness and saturation.<\/li>\n\n\n\n<li>The perceptual distance between the channels should be maximized.<\/li>\n<\/ol>\n\n\n\n<p>Since there are perceptually uniform colorspaces available in literature (for example CAM02-LCD <a href=\"https:\/\/doi.org\/10.1002\/col.20227\" data-type=\"link\" data-id=\"https:\/\/doi.org\/10.1002\/col.20227\">Luo et al. (2006)<\/a>), we can use these to design colormaps that match the figures of merit above:<\/p>\n\n\n\n<iframe loading=\"lazy\" src=\"https:\/\/trygvrad.github.io\/plotly_multivar_colormaps\/new_RGB_multivar.html\" height=\"520\" width=\"420\" frameborder=\"0\" allow=\"fullscreen\"><\/iframe>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-full\"><img loading=\"lazy\" decoding=\"async\" width=\"718\" height=\"303\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-1.png\" alt=\"\" class=\"wp-image-181\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-1.png 718w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-1-300x127.png 300w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-1-600x253.png 600w\" sizes=\"(max-width: 718px) 100vw, 718px\" \/><\/figure><\/div>\n\n\n<p>The above figure show the same data again but this time visualized with the newly generated colormaps. Again, they are shown with two different assignments to the three color channels. There are still perceptual differences, but there should be no features in the left image that are not visible in the right image. (Note that they will appear different to those that are colorblind, or if printed in black and white &#8211; more on this later.)<\/p>\n\n\n\n<h2 class=\"wp-block-heading\">Combining colors<\/h2>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"696\" height=\"252\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-38.png\" alt=\"\" class=\"wp-image-241\" style=\"width:838px;height:auto\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-38.png 696w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-38-300x109.png 300w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-38-600x217.png 600w\" sizes=\"(max-width: 696px) 100vw, 696px\" \/><\/figure>\n\n\n\n<p>When the three channels are combined, they may produce colors that do not exist in any of the individual channels. In the above example, the colors are added, but there are a other possible <a href=\"https:\/\/www.clipstudio.net\/how-to-draw\/archives\/154182\">blending modes<\/a>:<\/p>\n\n\n\n<ul class=\"wp-block-list\">\n<li><strong>Additive: R = R\u2081 + R\u2082 + R\u2083             \u2190 example above<\/strong><\/li>\n\n\n\n<li>Lighten:  R = max(R\u2081, R\u2082, R\u2083)<\/li>\n\n\n\n<li>Darken:   R = min(R\u2081, R\u2082, R\u2083)<\/li>\n\n\n\n<li>Multiply: R = R\u2081 * R\u2082 * R\u2083<\/li>\n\n\n\n<li>Screen:   R = (R\u2081\u207b\u00b9 * R\u2082\u207b\u00b9 * R\u2083\u207b\u00b9)\u207b\u00b9<\/li>\n\n\n\n<li>&#8230;<\/li>\n<\/ul>\n\n\n\n<p>as well as more exotic ways to work within colorspace:<\/p>\n\n\n\n<ul class=\"wp-block-list\">\n<li>Mixing in perceptual uniform space<\/li>\n\n\n\n<li>Non-linear mixing, e.g.  R = \u221a(R\u2081\u00b2 + R\u2082\u00b2 + R\u2083\u00b2)<\/li>\n\n\n\n<li>Choosing the colorbar corresponding to the highest input value, ignoring the others <\/li>\n\n\n\n<li>&#8230;<\/li>\n<\/ul>\n\n\n\n<p>In terms of perceptual uniformity, it would be best to combine the colors in perceptually uniform colorspace, but there are pragmatic reasons to instead combine colors sRGB:<\/p>\n\n\n\n<ul class=\"wp-block-list\">\n<li>The conversion sRGB \u2190\u2192 CAM02-LCD is numerically costly<\/li>\n\n\n\n<li>The conversion sRGB \u2190\u2192 CAM02-LCD is numerically unstable<\/li>\n\n\n\n<li>Combining colors in sRGB space gives acceptable results <\/li>\n<\/ul>\n\n\n\n<p>It is therefore reasonable to design colormaps in a perceptually uniform space, but combine them in sRGB. However, we must be carefull to check that that this does not produce any unwanted artifacts when the colormaps are combined. This is most acute for n = 3 channels, where it is possible to create colormaps such that each color in the output image stems from a unique combination of input.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\">Designing colormaps with n = 3 channels<\/h2>\n\n\n\n<p>With n=3 channels, we can think of colorspace as a cube, with each channel representing one of the axes. If we are working with dense data, such that the input spans the full 3D volume of the cube, then we can add the following two figures of merit:<\/p>\n\n\n\n<ol start=\"4\" class=\"wp-block-list\">\n<li class=\"ol {counter-reset: start 9}\">Equal mixing of the components provides a grayscale<\/li>\n\n\n\n<li>No combination leaves sRGB space<\/li>\n<\/ol>\n\n\n\n<p>We can visualize the colormaps above as follows:<\/p>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"262\" height=\"263\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-3-edited.png\" alt=\"\" class=\"wp-image-187\" style=\"width:259px;height:auto\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-3-edited.png 262w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-3-edited-150x150.png 150w\" sizes=\"(max-width: 262px) 100vw, 262px\" \/><\/figure><\/div>\n\n\n<p>By visual inspection we can see that this is relatively uniform around the origin (black), but non-uniform around the other extreme (white), where it wants to leave the sRGB colorspace. The same can be seen in 3D, where it also becomes apparent that the &#8220;greyscale&#8221; has a weak tint.<\/p>\n\n\n\n<iframe loading=\"lazy\" src=\"https:\/\/trygvrad.github.io\/plotly_multivar_colormaps\/new_RGB_multivar2.html\" height=\"520\" width=\"420\" frameborder=\"0\" allow=\"fullscreen\"><\/iframe>\n\n\n\n<p>We can adjust the colormap by reducing the maximum saturation and lightness of each channel, this to make sure the entire colormap fits in sRGB space. In the figure below the origin is fixed at (0, 0, 0) in sRGB space, and the maximum at (1, 1, 1). The grayscale has also been adjusted by minor shifts to the individual channels, so that the greyscale follows the sRGB greyscale.<\/p>\n\n\n\n<iframe loading=\"lazy\" src=\"https:\/\/trygvrad.github.io\/plotly_multivar_colormaps\/new_RGB_multivar3.html\" height=\"520\" width=\"420\" frameborder=\"0\" allow=\"fullscreen\"><\/iframe>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-full\"><img loading=\"lazy\" decoding=\"async\" width=\"563\" height=\"273\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-4.png\" alt=\"\" class=\"wp-image-188\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-4.png 563w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-4-300x145.png 300w\" sizes=\"(max-width: 563px) 100vw, 563px\" \/><\/figure><\/div>\n\n\n<p>This colormap fulfills all the figures of merit listed above, and will work for any 3-channel dataset. This particular example has sparse data (most pixels are only non-zero in one channel) and the resulting image therefore appears a little drab.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\">Colorblindness<\/h2>\n\n\n\n<p>Around 5-10% of the male population has some form of red-green colorblindness. For many of them, the colormap above looks as follows:<\/p>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-full\"><img loading=\"lazy\" decoding=\"async\" width=\"554\" height=\"273\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-5.png\" alt=\"\" class=\"wp-image-189\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-5.png 554w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-5-300x148.png 300w\" sizes=\"(max-width: 554px) 100vw, 554px\" \/><\/figure><\/div>\n\n\n<p>Note how the green and red channels appear almost identical. This is not an accident, but the result of a choice made when making the colormaps. The blue channel follows <em>negative b<\/em> (blue) closely in <em>L*a*b*<\/em> colorspace, and as a result the green and red channels have a very similar value of <em>positive b<\/em> (yellow). (red-green colorblindness is in practice the abscence of the <em>a<\/em> axis in <em>L*a*b*<\/em> colorspace).<\/p>\n\n\n\n<p>It is impossible to accommodate colorblindness completely in a 3-channel image. However, the choice made above was <em>particularly<\/em> bad. A better choice is to fix one of the channels to be along the <em>a<\/em> axis. The resulting colormap will then also have three distinct channels for those that are colorblind (grey, yellow, blue). <\/p>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-full\"><img loading=\"lazy\" decoding=\"async\" width=\"554\" height=\"273\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-8.png\" alt=\"\" class=\"wp-image-192\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-8.png 554w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-8-300x148.png 300w\" sizes=\"(max-width: 554px) 100vw, 554px\" \/><\/figure><\/div>\n\n\n<p>This is by no means perfect, but it is clearly a better choice. <br>For those of use who are not colorblind, the colormap above looks as follows:<\/p>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-full\"><img loading=\"lazy\" decoding=\"async\" width=\"554\" height=\"273\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-9.png\" alt=\"\" class=\"wp-image-193\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-9.png 554w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-9-300x148.png 300w\" sizes=\"(max-width: 554px) 100vw, 554px\" \/><\/figure><\/div>\n\n\n<iframe loading=\"lazy\" src=\"https:\/\/trygvrad.github.io\/plotly_multivar_colormaps\/new_RGB_multivar4.html\" height=\"520\" width=\"420\" frameborder=\"0\" allow=\"fullscreen\"><\/iframe>\n\n\n\n<h2 class=\"wp-block-heading\">The problem with black<\/h2>\n\n\n\n<p>When discretized to 12 steps, the colormaps look like this:<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"717\" height=\"75\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-10.png\" alt=\"\" class=\"wp-image-195\" style=\"width:839px;height:auto\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-10.png 717w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-10-300x31.png 300w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-10-600x63.png 600w\" sizes=\"(max-width: 717px) 100vw, 717px\" \/><\/figure>\n\n\n\n<p>On the right side, the individual segments can be easily discerned, but this is not true on the left, where several segments are effectively the same shade of black. I believe the issue is related to how most monitors cannot truly represent black in its purest form, and this is difficult to account for in the transformation form a perceptually linear colorspace to sRGB. <\/p>\n\n\n\n<p>We can slighly shift the colors in the colormap in order to improve the perceptual fidelity in the darkest parts of the colormap. <\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"717\" height=\"125\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-12.png\" alt=\"\" class=\"wp-image-197\" style=\"width:839px;height:auto\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-12.png 717w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-12-300x52.png 300w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-12-600x105.png 600w\" sizes=\"(max-width: 717px) 100vw, 717px\" \/><\/figure>\n\n\n\n<p>The approach used here is similar to a gamma correction, but acts independently on the lightness and the saturation. There is also a non-linearity applied when the origin is fixed to (0,0,0) in sRGB. The changes are best visualized by plotting the lightness, saturation and hue of each component:<\/p>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"889\" height=\"299\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-15.png\" alt=\"\" class=\"wp-image-200\" style=\"width:840px;height:auto\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-15.png 889w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-15-300x101.png 300w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-15-768x258.png 768w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-15-600x202.png 600w\" sizes=\"(max-width: 889px) 100vw, 889px\" \/><\/figure>\n\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"889\" height=\"299\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-16.png\" alt=\"\" class=\"wp-image-201\" style=\"width:840px;height:auto\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-16.png 889w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-16-300x101.png 300w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-16-768x258.png 768w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-16-600x202.png 600w\" sizes=\"(max-width: 889px) 100vw, 889px\" \/><\/figure>\n\n\n\n<p>It is worth noting that this is not an issue in the bright part of colorspace, and colormaps with white at the origin perform better with regard to perceptual uniformity:<br>(I refer to these as subtractive colormaps, in contrast to the additive colormaps discussed so far.)<\/p>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-full\"><img loading=\"lazy\" decoding=\"async\" width=\"554\" height=\"273\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-23.png\" alt=\"\" class=\"wp-image-209\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-23.png 554w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-23-300x148.png 300w\" sizes=\"(max-width: 554px) 100vw, 554px\" \/><\/figure><\/div>\n\n\n<figure class=\"wp-block-image size-full is-resized\"><img loading=\"lazy\" decoding=\"async\" width=\"717\" height=\"57\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-17.png\" alt=\"\" class=\"wp-image-202\" style=\"width:838px;height:auto\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-17.png 717w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-17-300x24.png 300w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-17-600x48.png 600w\" sizes=\"(max-width: 717px) 100vw, 717px\" \/><\/figure>\n\n\n\n<figure class=\"wp-block-image size-full\"><img loading=\"lazy\" decoding=\"async\" width=\"888\" height=\"274\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-20.png\" alt=\"\" class=\"wp-image-206\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-20.png 888w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-20-300x93.png 300w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-20-768x237.png 768w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-20-600x185.png 600w\" sizes=\"(max-width: 888px) 100vw, 888px\" \/><\/figure>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-full\"><img loading=\"lazy\" decoding=\"async\" width=\"571\" height=\"273\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-21.png\" alt=\"\" class=\"wp-image-207\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-21.png 571w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-21-300x143.png 300w\" sizes=\"(max-width: 571px) 100vw, 571px\" \/><\/figure><\/div>\n\n\n<h2 class=\"wp-block-heading\"> Colormaps with n \u2265  4 channels<\/h2>\n\n\n\n<p>For n \u2265 4, different each color in colorspace is no longer unique (there may be different ways to produce some of the same color in the image) and are therefore best applied only to sparse data (most pixels are only non-zero in one channel so that each pixel in the resulting image has a color close to one of the colorbars). This means that less attention should be paid to how the colormaps combine, as the combined colors are expected to rarely appear in the intended use case. We therefore use only the three first figures of merit:<\/p>\n\n\n\n<ol class=\"wp-block-list\">\n<li>Each channel should be perceptually uniform.<\/li>\n\n\n\n<li>All channels should have similar lightness and saturation.<\/li>\n\n\n\n<li>The perceptual distance between the channels should be maximized.<\/li>\n\n\n\n<li><s>Equal mixing of the components provides a grayscale<\/s><\/li>\n\n\n\n<li><s>No combination leaves sRGB space<\/s><\/li>\n<\/ol>\n\n\n\n<p>Keeping all the other points discussed above in mind (adjusting dark colors, rotating the hues to maximize difference in color for those that are colorblind) we can produce colormaps with 4-8 colors:<\/p>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-full\"><img loading=\"lazy\" decoding=\"async\" width=\"717\" height=\"58\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-29.png\" alt=\"\" class=\"wp-image-216\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-29.png 717w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-29-300x24.png 300w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-29-600x49.png 600w\" sizes=\"(max-width: 717px) 100vw, 717px\" \/><\/figure><\/div>\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-full\"><img loading=\"lazy\" decoding=\"async\" width=\"717\" height=\"58\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-33.png\" alt=\"\" class=\"wp-image-220\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-33.png 717w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-33-300x24.png 300w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-33-600x49.png 600w\" sizes=\"(max-width: 717px) 100vw, 717px\" \/><\/figure><\/div>\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-full\"><img loading=\"lazy\" decoding=\"async\" width=\"717\" height=\"58\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-30.png\" alt=\"\" class=\"wp-image-217\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-30.png 717w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-30-300x24.png 300w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-30-600x49.png 600w\" sizes=\"(max-width: 717px) 100vw, 717px\" \/><\/figure><\/div>\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-full\"><img loading=\"lazy\" decoding=\"async\" width=\"717\" height=\"58\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-31.png\" alt=\"\" class=\"wp-image-218\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-31.png 717w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-31-300x24.png 300w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-31-600x49.png 600w\" sizes=\"(max-width: 717px) 100vw, 717px\" \/><\/figure><\/div>\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-full\"><img loading=\"lazy\" decoding=\"async\" width=\"717\" height=\"58\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-32.png\" alt=\"\" class=\"wp-image-219\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-32.png 717w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-32-300x24.png 300w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-32-600x49.png 600w\" sizes=\"(max-width: 717px) 100vw, 717px\" \/><\/figure><\/div>\n\n\n<p>We can evaluate these as we did with the n=3 colormaps, here for 4 and 8 colors.<\/p>\n\n\n\n<figure class=\"wp-block-image size-full\"><img loading=\"lazy\" decoding=\"async\" width=\"889\" height=\"290\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-35.png\" alt=\"\" class=\"wp-image-222\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-35.png 889w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-35-300x98.png 300w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-35-768x251.png 768w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-35-600x196.png 600w\" sizes=\"(max-width: 889px) 100vw, 889px\" \/><\/figure>\n\n\n\n<figure class=\"wp-block-image size-full\"><img loading=\"lazy\" decoding=\"async\" width=\"889\" height=\"290\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-34.png\" alt=\"\" class=\"wp-image-221\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-34.png 889w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-34-300x98.png 300w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-34-768x251.png 768w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-34-600x196.png 600w\" sizes=\"(max-width: 889px) 100vw, 889px\" \/><\/figure>\n\n\n\n<p>We see that in both lightness and saturation there are some inconsistencies between different colors. This is because the colormaps approach the limits of sRGB space. The inconsistencies could have been avoided by reducing the maximum lightness and saturation, which would in turn results in more dull colormaps. These colormaps are the result of attempting to strike a balance between vibrant colormaps and perceptual uniformity.<\/p>\n\n\n\n<p>(For data that is <em>not<\/em> sparse a different combination mode may be used, but that topic goes beyond the scope of this post.)<\/p>\n\n\n\n<blockquote class=\"wp-block-quote is-layout-flow wp-block-quote-is-layout-flow\">\n<h2 class=\"wp-block-heading\">A set of colormaps with no bad choices<\/h2>\n\n\n\n<p>Combining all these together produces the following colormaps:<\/p>\n<\/blockquote>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-large\"><img loading=\"lazy\" decoding=\"async\" width=\"1024\" height=\"549\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-36-1024x549.png\" alt=\"\" class=\"wp-image-223\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-36-1024x549.png 1024w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-36-300x161.png 300w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-36-768x412.png 768w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-36-1536x824.png 1536w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-36-2048x1098.png 2048w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-36-1400x751.png 1400w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-36-600x322.png 600w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" \/><\/figure><\/div>\n\n\n<ul class=\"wp-block-list\">\n<li>Two (A, B) variants for n = 2 with different hues\n<ul class=\"wp-block-list\">\n<li>Both variants <strong>stay within sRGB<\/strong> and end at white when combined at the maximum<\/li>\n<\/ul>\n<\/li>\n\n\n\n<li>Four colormaps for n = 3\n<ul class=\"wp-block-list\">\n<li>A and B are designed so that all combinations <strong>stay within sRGB<\/strong> space\n<ul class=\"wp-block-list\">\n<li>A and B have different hues<\/li>\n<\/ul>\n<\/li>\n\n\n\n<li>C and D are designed to <strong>exceed sRGB space<\/strong>\n<ul class=\"wp-block-list\">\n<li>C has the same hue as A and D has the same hue as B<\/li>\n<\/ul>\n<\/li>\n<\/ul>\n<\/li>\n\n\n\n<li>Two colormaps for n = 4 with different hues\n<ul class=\"wp-block-list\">\n<li>Both  alternatives <strong>exceed sRGB space<\/strong><\/li>\n<\/ul>\n<\/li>\n\n\n\n<li>One alternative for each of n = 5, 6, 7 and 8\n<ul class=\"wp-block-list\">\n<li>At n=8 is the result of combining the two sets at n = 4<\/li>\n<\/ul>\n<\/li>\n<\/ul>\n\n\n\n<p>As noted previously, the <em>subtractive<\/em> colormaps are more perceptually uniform:<\/p>\n\n\n\n<figure class=\"wp-block-image size-large\"><img loading=\"lazy\" decoding=\"async\" width=\"1024\" height=\"549\" src=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-37-1024x549.png\" alt=\"\" class=\"wp-image-224\" srcset=\"http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-37-1024x549.png 1024w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-37-300x161.png 300w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-37-768x412.png 768w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-37-1536x824.png 1536w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-37-2048x1098.png 2048w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-37-1400x751.png 1400w, http:\/\/bentus\/wp-content\/uploads\/2024\/07\/image-37-600x322.png 600w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" \/><\/figure>\n\n\n\n<p>By conforming to the figures of merit, we ensure that the most common pitfalls when choosing a colormap can be avoided. <strong>I.e. these colormaps will never be a bad choice<\/strong>. As such, they form a suitable basis set for general-purpose plotting software, such as matplotlib, pyplot, pyqtgraph, and others.<\/p>\n\n\n\n<p><\/p>\n","protected":false},"excerpt":{"rendered":"<p>Much work has been done in the last decade related to 1-dimensional colormaps (see for eaxmple Peter Kovesis paper and Nathaniel Smith and St\u00e9fan van der Walts talk (2015)). This post follows my previous post on 2D colormaps, and many of the design principles will be the same. However, with n \u2265 3, it quickly&#8230; <a class=\"more-link\" href=\"http:\/\/bentus\/multivariate-colormaps-for-n-dimensions\/#more-159\">Continue Reading &rarr;<\/a><\/p>\n","protected":false},"author":1,"featured_media":223,"comment_status":"closed","ping_status":"open","sticky":true,"template":"","format":"standard","meta":{"footnotes":""},"categories":[1],"tags":[],"class_list":["post-159","post","type-post","status-publish","format-standard","has-post-thumbnail","hentry","category-uncategorized","clear"],"_links":{"self":[{"href":"http:\/\/bentus\/wp-json\/wp\/v2\/posts\/159"}],"collection":[{"href":"http:\/\/bentus\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/bentus\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/bentus\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/bentus\/wp-json\/wp\/v2\/comments?post=159"}],"version-history":[{"count":27,"href":"http:\/\/bentus\/wp-json\/wp\/v2\/posts\/159\/revisions"}],"predecessor-version":[{"id":244,"href":"http:\/\/bentus\/wp-json\/wp\/v2\/posts\/159\/revisions\/244"}],"wp:featuredmedia":[{"embeddable":true,"href":"http:\/\/bentus\/wp-json\/wp\/v2\/media\/223"}],"wp:attachment":[{"href":"http:\/\/bentus\/wp-json\/wp\/v2\/media?parent=159"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/bentus\/wp-json\/wp\/v2\/categories?post=159"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/bentus\/wp-json\/wp\/v2\/tags?post=159"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}